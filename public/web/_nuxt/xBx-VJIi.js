import{W as T}from"./D2b5iAmY.js";import{d as j,ae as H,f as p,a1 as N,g as P,i as V,G as C,aR as U,w as I,j as Y,o as D,k as E,m as $,x as J,Y as K}from"#entry";import{_ as L}from"./DlAUqK2U.js";const Q=["width","height"],X=j({__name:"content",props:{squareSize:{default:4},gridGap:{default:6},flickerChance:{default:.3},color:{default:"rgb(0, 0, 0)"},maxOpacity:{default:.2},class:{default:""},style:{}},setup(A){const g=A,{squareSize:s,gridGap:v,flickerChance:z,color:R,maxOpacity:k}=H(g),f=p(),n=p(),d=p(),S=p(!1),w=N({width:0,height:0});let m=null,h=null,i,x=0;const F=P(()=>{if(!d.value)return"rgba(0, 0, 0,";if(R.value.startsWith("rgb("))return R.value.replace("rgb(","rgba(").replace(")",",");const e=R.value.replace(/^#/,""),t=Number.parseInt(e,16),a=t>>16&255,c=t>>8&255,u=t&255;return`rgba(${a}, ${c}, ${u},`}),o=p();function M(e,t,a){const c=window.devicePixelRatio||1;e.width=t*c,e.height=a*c,e.style.width=`${t}px`,e.style.height=`${a}px`;const u=Math.floor(t/(s.value+v.value)),_=Math.floor(a/(s.value+v.value)),l=new Float32Array(u*_);for(let r=0;r<l.length;r++)l[r]=Math.random()*k.value;return{cols:u,rows:_,squares:l,dpr:c}}function O(e,t){for(let a=0;a<e.length;a++)Math.random()<z.value*t&&(e[a]=Math.random()*k.value)}function B(e,t,a,c,u,_,l){e.clearRect(0,0,t,a),e.fillStyle="transparent",e.fillRect(0,0,t,a);for(let r=0;r<c;r++)for(let y=0;y<u;y++){const G=_[r*u+y];e.fillStyle=`${F.value}${G})`,e.fillRect(r*(s.value+v.value)*l,y*(s.value+v.value)*l,s.value*l,s.value*l)}}function b(){if(!f.value||!n.value)return;const e=f.value.clientWidth,t=f.value.clientHeight;w.width=e,w.height=t,e>0&&t>0&&(o.value=M(n.value,e,t))}function q(e){if(!S.value||!o.value||!d.value||!n.value)return;const t=(e-x)/1e3;x=e,O(o.value.squares,t),B(d.value,n.value.width,n.value.height,o.value.cols,o.value.rows,o.value.squares,o.value.dpr),i=requestAnimationFrame(q)}function W(){i&&cancelAnimationFrame(i),x=performance.now(),i=requestAnimationFrame(q)}return V(()=>{!n.value||!f.value||(d.value=n.value.getContext("2d")||void 0,d.value&&(b(),m=new ResizeObserver(()=>{C(()=>{b()})}),h=new IntersectionObserver(([e])=>{e&&(S.value=e.isIntersecting,e.isIntersecting&&W())},{threshold:0}),m.observe(f.value),h.observe(n.value)))}),U(()=>{i&&(cancelAnimationFrame(i),i=void 0),m&&(m.disconnect(),m=null),h&&(h.disconnect(),h=null)}),I(()=>g.style,()=>{C(()=>{b()})},{deep:!0}),I([s,v,z,k],()=>{C(()=>{b()})}),(e,t)=>(D(),Y(T,{style:K(g.style),"override-bg-color":!0,"custom-class":"flickering-grid-content"},{default:E(({style:a})=>[$("div",{ref_key:"containerRef",ref:f,class:J([g.class,"flickering-grid-container"])},[$("canvas",{ref_key:"canvasRef",ref:n,class:"pointer-events-none",width:w.width,height:w.height},null,8,Q)],2)]),_:1},8,["style"]))}}),ae=L(X,[["__scopeId","data-v-f1e15c21"]]);export{ae as default};
