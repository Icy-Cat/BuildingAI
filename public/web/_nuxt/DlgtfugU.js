const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bc6CzCAS.js","./BHGRVy27.js","./BMWUekhH.js","./D6QomrDA.js","./DNZiHWQV.js","./zPUvkbEL.js","./BNqXk1Oe.js","./b-_TUx9i.js","./B22A-h4k.js","./Cfcu-t3n.js","./DK1-6_6O.js","./CstU5cVH.js","./BT1VXOqk.js","./CP4Zo7YT.js","./XpsTG8vq.js","./CfrQ6h6x.js","./DodGX9aM.js","./BWWuJQeZ.js","./DN9ov8OT.js","./9bDOsXij.js","./pUN2d83w.js","./Cpt2kRVT.js","./8-c-A7PB.js","./iHyFjswr.js","./DDkKkiq3.js","./BcgmQzdY.js","./Cy32TTiG.js","./BcW6AN96.js","./-aacq5Xj.js","./Cgx-pZ0i.js","./CjnkMdLn.js","./Bc7ldEoJ.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as T,b as F,Q as K,e as O,a1 as N,g as H,i as j,c as q,o as G,m as h,l as r,p as o,k as i,z as Q,q as w,t as g,h as a,R as C,U as x}from"#entry";import{_ as J}from"./DodGX9aM.js";import{_ as W}from"./BvrbnHlJ.js";import{_ as X}from"./BHGRVy27.js";import Y from"./-aacq5Xj.js";import{_ as Z}from"./Bpk8zbrs.js";import{_ as ee}from"./DJ8q3BOv.js";import{_ as oe}from"./B19A1O9i.js";import{_ as te}from"./D6QomrDA.js";import{_ as se}from"./BNeK5zSK.js";import{e as le,f as ae,g as re}from"./Cy32TTiG.js";import{u as ne}from"./Dp_0VxUw.js";import{u as ie}from"./FihYtau-.js";import{u as ce}from"./BvugyUor.js";import"./BWWuJQeZ.js";import"./DN9ov8OT.js";import"./9bDOsXij.js";import"./B22A-h4k.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./iHyFjswr.js";import"./DDkKkiq3.js";import"./BaddN8Qc.js";import"./kRIii9yh.js";import"./BwjX1SxC.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Bub1HYiY.js";import"./XpsTG8vq.js";import"./DlAUqK2U.js";const de={class:"role-list-container pb-5"},me={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},pe={class:"flex items-end gap-2 md:ml-auto"},ue={class:"mt-auto flex items-center justify-between gap-3 pt-4"},ge={class:"text-muted text-sm"},_e={class:"flex items-center gap-1.5"},Xe=T({__name:"list",setup(fe){const k=C(()=>x(()=>import("./Bc6CzCAS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),U=C(()=>x(()=>import("./CfrQ6h6x.js"),__vite__mapDeps([15,2,16,17,18,19,8,20,21,22,23,24,4,5,6,7,9,10,11,12,13,14,25,26]),import.meta.url)),$=C(()=>x(()=>import("./BcW6AN96.js"),__vite__mapDeps([27,2,28,29,24,30,31,4,5,6,7,8,9,10,11,12,13,14,26,32,33]),import.meta.url)),A=J,c=Q,I=W,D=X,{t:l}=F(),{hasAccessByCodes:b}=ne(),y=K(),n=O("table"),_=N({name:"",description:""}),{paging:d,getLists:m}=ie({fetchFun:le,params:_}),p=H(()=>({select:l("console-common.select"),name:l("system-perms.role.name"),description:l("system-perms.role.describe"),status:l("console-common.status"),createdAt:l("console-common.createAt"),accountCount:l("system-perms.role.usersCount"),actions:l("console-common.operation")})),z=[{id:"select",header:({table:e})=>a(A,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:e})=>a(A,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>e.toggleSelected(!!t),ariaLabel:"Select row"})},{accessorKey:"name",header:()=>a("p",{class:""},`${p.value.name}`),cell:({row:e})=>a("div",{class:"flex items-center gap-3"},[a("div",void 0,[a("p",{class:""},`@${e.original.name}`)])])},{accessorKey:"description",header:()=>a("p",{class:""},`${p.value.description}`),cell:({row:e})=>{const t=e.getValue("description");return a("div",{class:"max-w-xs truncate"},t)}},{accessorKey:"users",header:()=>a("p",{class:""},`${p.value.accountCount}`),cell:({row:e})=>{const t=e.getValue("users");return a("div",{class:"max-w-xs truncate"},t.length)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return a(c,{color:"neutral",variant:"ghost",label:p.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");return a(D,{datetime:t,mode:"datetime"})}},{id:"actions",header:()=>a("p",{class:""},`${p.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:e})=>a("div",{class:"flex items-center gap-1"},[b(["role:update"])?a(c,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:l("console-common.edit"),onClick:()=>{R(e.original.id||"")}}):null,b(["role:permissions"])?a(c,{icon:"i-lucide-shield-check",color:"primary",variant:"ghost",size:"xs",label:l("system-perms.role.permissions"),onClick:()=>{M(e.original.id||"")}}):null,b(["role:delete"])?a(c,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:l("console-common.delete"),onClick:()=>{S(e.original.id)}}):null].filter(Boolean))}],R=async e=>{await y.create($).open({id:e??null}).result&&m()},M=async e=>{await y.create(U).open({id:e}).result&&m()},P=(e,t)=>{y.create(k).open({users:e,roleName:t})},S=async e=>{try{await ce({title:l("system-perms.role.deleteTitle"),description:l("system-perms.role.deleteMsg"),color:"error"}),Array.isArray(e)?await ae({ids:e}):await re(e),m()}catch(t){console.error("删除失败:",t)}};return j(()=>m()),(e,t)=>{const f=Y,v=Z,V=ee,B=oe,E=te,L=se;return G(),q("div",de,[h("div",me,[r(f,{modelValue:o(_).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(_).name=s),placeholder:o(l)("system-perms.role.nameInput"),onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),r(f,{modelValue:o(_).description,"onUpdate:modelValue":t[1]||(t[1]=s=>o(_).description=s),placeholder:o(l)("system-perms.role.descriptionInput"),ui:{root:"max-w-xs w-full"},onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),h("div",pe,[r(V,{codes:["role:delete"]},{default:i(()=>[r(o(c),{color:"error",variant:"subtle",label:o(l)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length,onClick:t[2]||(t[2]=s=>S(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.map(u=>u.original.id)))},{trailing:i(()=>[r(v,null,{default:i(()=>[w(g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),r(o(I),{items:o(n)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:o(p)[s?.id]||s.columnDef.header,type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(u){o(n)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!u)},onSelect(u){u?.preventDefault()}})),content:{align:"end"}},{default:i(()=>[r(o(c),{label:o(l)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),r(V,{codes:["role:create"]},{default:i(()=>[r(o(c),{icon:"i-heroicons-plus",color:"primary",onClick:t[3]||(t[3]=()=>R(null))},{default:i(()=>[w(g(o(l)("system-perms.role.add")),1)]),_:1})]),_:1})])]),r(E,{loading:o(d).loading,data:o(d).items,columns:z,class:"h-[calc(100vh-13rem)] shrink-0",ref_key:"table",ref:n,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},{"users-cell":i(({row:s})=>[r(B,{class:"cursor-pointer",color:"primary",onClick:u=>P(s.original.users,s.original.name)},{default:i(()=>[w(g(s.original.users.length),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","data"]),h("div",ue,[h("div",ge,g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+g(o(n)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+g(o(l)("console-common.selected"))+". ",1),h("div",_e,[r(L,{page:o(d).page,"onUpdate:page":t[4]||(t[4]=s=>o(d).page=s),size:o(d).pageSize,"onUpdate:size":t[5]||(t[5]=s=>o(d).pageSize=s),total:o(d).total,onChange:o(m)},null,8,["page","size","total","onChange"])])])])}}});export{Xe as default};
