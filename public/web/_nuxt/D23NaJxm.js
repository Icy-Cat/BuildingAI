const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B9aqQSEP.js","./DChYRXkg.js","./DFBCXxNw.js","./BwjX1SxC.js","./Bub1HYiY.js","./B22A-h4k.js","./Bpk8zbrs.js","./XpsTG8vq.js","./BHGRVy27.js","./CGWnnGY2.js","./BvrbnHlJ.js","./BaddN8Qc.js","./8-c-A7PB.js","./kRIii9yh.js","./Cfcu-t3n.js","./C6Y-ieo6.js","./b-_TUx9i.js","./DaNf1Wdt.js","./CKXZhss7.js","./Cpt2kRVT.js","./pUN2d83w.js","./DodGX9aM.js","./BWWuJQeZ.js","./DN9ov8OT.js","./9bDOsXij.js","./iHyFjswr.js","./DDkKkiq3.js","./Dp_0VxUw.js","./Bl6IL-dW.js","./B19A1O9i.js","./_1k1KbFY.js","./BMSQkwth.js","./DaWZu8wl.js","./EL_6giR3.js","./Qjq6OWkd.js","./BT1VXOqk.js","./Dn8X9Gvz.js","./DlAUqK2U.js","./DNZiHWQV.js","./zPUvkbEL.js","./BNqXk1Oe.js","./DK1-6_6O.js","./CstU5cVH.js","./CP4Zo7YT.js","./B4OkYrwN.js","./Bni8bPEl.js"])))=>i.map(i=>d[i]);
import{d as ae,aq as se,b as ne,e as le,Q as ie,a1 as re,s as B,h as k,g as I,i as ce,c as f,o as m,m as l,j as h,n as de,l as i,p as t,k as r,t as c,z as me,q as C,A as pe,C as ue,_ as _e,F as ge,B as fe,R as P,U as T}from"#entry";import{_ as he}from"./DodGX9aM.js";import{_ as be}from"./BHGRVy27.js";import ve from"./-aacq5Xj.js";import{_ as ye}from"./DX4LiDXp.js";import{_ as ke}from"./Bpk8zbrs.js";import{_ as Ce}from"./DJ8q3BOv.js";import{_ as xe}from"./COzfqa7N.js";import{_ as we}from"./B19A1O9i.js";import{_ as De}from"./BvrbnHlJ.js";import{_ as Se}from"./D6QomrDA.js";import{_ as Ae}from"./Qjq6OWkd.js";import{_ as Ue}from"./BNeK5zSK.js";import{c as Ve,d as $e,e as ze}from"./B4OkYrwN.js";import{u as Be}from"./Dp_0VxUw.js";import{u as Ie}from"./FihYtau-.js";import{u as Pe}from"./BvugyUor.js";import"./BWWuJQeZ.js";import"./DN9ov8OT.js";import"./9bDOsXij.js";import"./B22A-h4k.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./iHyFjswr.js";import"./DDkKkiq3.js";import"./BaddN8Qc.js";import"./kRIii9yh.js";import"./BwjX1SxC.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Bub1HYiY.js";import"./xli8Y-dU.js";import"./CP4Zo7YT.js";import"./XpsTG8vq.js";import"./Dn8X9Gvz.js";import"./BT1VXOqk.js";import"./DlAUqK2U.js";const Te={class:"conversation-list-container pb-5"},Re={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-2"},Ke={class:"flex items-center gap-2 md:ml-auto"},Ne={class:"flex items-center gap-2"},Ee={class:"text-muted-foreground text-sm"},Le={class:"flex items-center gap-2"},je={class:"flex items-center gap-2"},Fe={class:"text-primary"},Me={class:"text-success"},Oe={class:"mt-2 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},qe={key:2,class:"flex h-[calc(100vh-13rem)] items-center justify-center"},Ge={class:"flex items-center gap-3"},He={class:"text-accent-foreground"},Qe={key:3,class:"flex h-[calc(100vh-13rem)] flex-col items-center justify-center"},Je={class:"text-secondary-foreground mb-2 text-lg font-medium"},We={class:"text-accent-foreground"},Xe={key:4,class:"bg-background sticky bottom-0 z-10 flex items-center justify-between gap-3 py-4"},Ye={class:"text-muted text-sm"},Ze={class:"flex items-center gap-1.5"},Ft=ae({__name:"list",setup(et){const R=P(()=>T(()=>import("./B9aqQSEP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url)),K=P(()=>T(()=>import("./Bl6IL-dW.js"),__vite__mapDeps([28,1,8,29,30,31,32,33,34,35,36,37,38,39,40,16,5,14,41,42,43,7,44,45]),import.meta.url)),b=he,N=be,{hasAccessByCodes:E}=Be(),x=se(),{t:n}=ne(),w=le("table"),L=ie(),p=re({keyword:"",modelId:"",startDate:"",endDate:""}),_=B(1),j=[{value:1,icon:"i-lucide-list"},{value:2,icon:"i-tabler-layout-grid"}],d=B(new Set),{paging:s,getLists:g}=Ie({fetchFun:Ve,params:p}),D=(e,o)=>{if(typeof o=="boolean"){const u=e.id;o?d.value.add(u):d.value.delete(u)}},F=[{id:"select",header:({table:e})=>k(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o),S(o)},"aria-label":"Select all"}),cell:({row:e})=>k(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o),D(e.original,o)},"aria-label":"Select row"})},{accessorKey:"title",header:n("ai-chat.backend.list.title")},{accessorKey:"userName",header:n("ai-chat.backend.list.userName")},{accessorKey:"messageCount",header:n("ai-chat.backend.list.messageCount")},{accessorKey:"totalTokens",header:n("ai-chat.backend.list.totalTokens")},{accessorKey:"totalPower",header:n("ai-chat.backend.list.totalPower")},{accessorKey:"updatedAt",header:n("console-common.updateAt"),cell:({row:e})=>{const o=e.getValue("updatedAt");return k(N,{datetime:o,mode:"datetime"})}},{accessorKey:"action",header:n("console-common.operation"),size:40,enableSorting:!1,enableHiding:!1}];function M(e){return[{label:n("order.backend.recharge.list.viewDetails"),icon:"i-lucide-eye",color:"info",onClick:()=>{v(e.original.id)}},E(["ai-conversations:ai_conversation_delete"])?{label:n("console-common.delete"),icon:"i-lucide-trash-2",color:"error",onSelect(){U(e.original)}}:null].filter(Boolean)}const S=e=>{const o=e===!0;w.value?.tableApi.toggleAllPageRowsSelected(!!e),o?s.items.forEach(u=>{d.value.add(u.id)}):d.value.clear()},A=async e=>{try{await Pe({title:n("ai-chat.backend.delete.title"),description:n("ai-chat.backend.delete.description"),color:"error",cancelText:n("console-common.cancel"),confirmText:n("console-common.confirm")}),Array.isArray(e)?(await $e(e),x.success(n("common.message.deleteBatchSuccess"))):(await ze(e),x.success(n("common.message.deleteSuccess"))),d.value.clear(),g()}catch(o){console.error("Delete failed:",o)}},U=e=>{A(e.id)},O=()=>{const e=Array.from(d.value);e.length!==0&&A(e)},q=e=>{L.create(K).open({conversationId:e})},v=e=>{q(e)},G=I(()=>s.items.length>0&&s.items.every(e=>d.value.has(e.id))),H=I(()=>{const e=s.items.filter(o=>d.value.has(o.id)).length;return e>0&&e<s.items.length}),Q=e=>{v(e.original.id)};return ce(()=>g()),(e,o)=>{const u=ve,J=ye,W=ke,V=me,X=Ce,Y=xe,y=_e,$=ue,Z=we,ee=De,te=Se,z=Ae,oe=Ue;return m(),f("div",Te,[l("div",Re,[i(u,{modelValue:t(p).keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>t(p).keyword=a),placeholder:e.$t("ai-chat.backend.search.placeholder"),onChange:t(g)},null,8,["modelValue","placeholder","onChange"]),i(J,{start:t(p).startDate,"onUpdate:start":o[1]||(o[1]=a=>t(p).startDate=a),end:t(p).endDate,"onUpdate:end":o[2]||(o[2]=a=>t(p).endDate=a),ui:{root:"w-auto sm:w-xs"},onChange:t(g)},null,8,["start","end","onChange"]),l("div",Ke,[l("div",Ne,[i(t(b),{"model-value":t(G)?!0:t(H)?"indeterminate":!1,"onUpdate:modelValue":S},{label:r(()=>[l("span",Ee,c(t(d).size)+" / "+c(t(s).items.length)+" "+c(t(n)("console-common.selected")),1)]),_:1},8,["model-value"])]),i(X,{codes:["ai_conversation_delete"]},{default:r(()=>[i(V,{color:"error",variant:"subtle",label:e.$t("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:t(d).size===0,onClick:O},{trailing:r(()=>[i(W,null,{default:r(()=>[C(c(t(d).size),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),i(Y,{modelValue:t(_),"onUpdate:modelValue":o[3]||(o[3]=a=>pe(_)?_.value=a:null),items:j,size:"xs",ui:{root:"gap-0",indicator:"bg-background dark:bg-primary",leadingIcon:"bg-black dark:bg-white"}},null,8,["modelValue"])])]),!t(s).loading&&t(s).items.length>0&&t(_)===1?(m(),h(z,{key:0,class:"h-[calc(100vh-13rem)] pt-2",shadow:!1},{default:r(()=>[i(te,{ref_key:"table",ref:w,data:t(s).items,columns:F,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default cursor-pointer",tr:"[&:has(>td[colspan])]:hidden"},onSelect:Q},{"title-cell":r(({row:a})=>[l("div",Le,[i(y,{name:"i-lucide-message-circle",class:"text-primary size-5"}),C(" "+c(a.original.title||"new Chat"),1)])]),"userName-cell":r(({row:a})=>[l("div",je,[a.original.user?.avatar?(m(),h($,{key:0,src:a.original.user?.avatar},null,8,["src"])):(m(),h($,{key:1,icon:"i-heroicons-user",name:a.original.user?.username},null,8,["name"])),l("span",null,c(a.original.user?.nickname),1)])]),"messageCount-cell":r(({row:a})=>[i(Z,{color:"primary",variant:"subtle"},{default:r(()=>[C(c(a.original.messageCount),1)]),_:2},1024)]),"totalTokens-cell":r(({row:a})=>[l("span",Fe,c(a.original.totalTokens),1)]),"totalPower-cell":r(({row:a})=>[l("span",Me,c(a.original.totalPower),1)]),"action-cell":r(({row:a})=>[i(ee,{items:M(a)},{default:r(()=>[i(V,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost","aria-label":"Actions"})]),_:1},8,["items"])]),_:1},8,["data"])]),_:1})):!t(s).loading&&t(s).items.length>0&&t(_)===2?(m(),h(z,{key:1,class:"h-[calc(100vh-13rem)]",shadow:!1},{default:r(()=>[l("div",Oe,[(m(!0),f(ge,null,fe(t(s).items,a=>(m(),h(t(R),{key:a.id,conversation:a,selected:t(d).has(a.id),onSelect:D,onDelete:U,onViewDetail:v},null,8,["conversation","selected"]))),128))])]),_:1})):t(s).loading?(m(),f("div",qe,[l("div",Ge,[i(y,{name:"i-lucide-loader-2",class:"text-primary-500 h-6 w-6 animate-spin"}),l("span",He,c(e.$t("common.loading")),1)])])):(m(),f("div",Qe,[i(y,{name:"i-lucide-message-circle",class:"text-muted mb-4 h-16 w-16"}),l("h3",Je,c(e.$t("ai-chat.backend.empty.title")),1),l("p",We,c(e.$t("ai-chat.backend.empty.description")),1)])),t(s).total>0?(m(),f("div",Xe,[l("div",Ye,c(t(d).size)+" "+c(e.$t("console-common.selected")),1),l("div",Ze,[i(oe,{page:t(s).page,"onUpdate:page":o[4]||(o[4]=a=>t(s).page=a),size:t(s).pageSize,"onUpdate:size":o[5]||(o[5]=a=>t(s).pageSize=a),total:t(s).total,onChange:t(g)},null,8,["page","size","total","onChange"])])])):de("",!0)])}}});export{Ft as default};
