import{d as E,b as S,aq as F,g as K,aK as N,j as M,o as b,k as o,l as t,p as r,m as n,t as c,z as I,q as h,c as v,bs as T,_ as j}from"#entry";import q from"./-aacq5Xj.js";import{_ as z}from"./Cgx-pZ0i.js";import{_ as D}from"./-p_U-LXi.js";import{_ as J}from"./D6QomrDA.js";import{_ as L}from"./Bc7ldEoJ.js";import{_ as O}from"./DNZiHWQV.js";import{d as G}from"./C2dsOzpu.js";import"./DDkKkiq3.js";import"./DN9ov8OT.js";import"./iHyFjswr.js";import"./zPUvkbEL.js";import"./BNqXk1Oe.js";import"./b-_TUx9i.js";import"./B22A-h4k.js";import"./Cfcu-t3n.js";import"./DK1-6_6O.js";import"./CstU5cVH.js";import"./BT1VXOqk.js";import"./CP4Zo7YT.js";import"./XpsTG8vq.js";import"./DodGX9aM.js";import"./BWWuJQeZ.js";import"./9bDOsXij.js";import"./pUN2d83w.js";import"./Cpt2kRVT.js";import"./8-c-A7PB.js";import"./BvrbnHlJ.js";import"./BaddN8Qc.js";import"./kRIii9yh.js";import"./BwjX1SxC.js";import"./C6Y-ieo6.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Bub1HYiY.js";import"./Bpk8zbrs.js";import"./DJ8q3BOv.js";import"./B19A1O9i.js";import"./D39yG5RA.js";import"./xli8Y-dU.js";import"./Dp_0VxUw.js";import"./BvugyUor.js";const H={class:"text-lg font-semibold"},P={class:"text-muted-foreground flex items-center gap-2 text-sm"},Q={key:0,class:"flex-none"},W={key:1,class:"flex-none"},X={class:"flex w-full items-center gap-2"},Y={class:"text-muted-foreground text-sm"},Z={class:"flex w-full justify-end gap-2 pt-3.5"},De=E({__name:"model-batch-edit",props:{models:{},provider:{}},emits:["close"],setup(m,{emit:V}){const _=m,p=V,{t:a}=S(),g=F(),k=[{accessorKey:"name",header:a("ai-provider.backend.model.batchEdit.name")},{accessorKey:"model",header:a("ai-provider.backend.model.batchEdit.model")},{accessorKey:"maxContext",header:a("ai-provider.backend.model.batchEdit.maxContext")},{accessorKey:"isActive",header:a("ai-provider.backend.model.batchEdit.isActive")},{accessorKey:"billingRule",header:a("ai-provider.backend.model.batchEdit.billingRule")}],f=K(()=>_.models.size===0?[]:JSON.parse(JSON.stringify([..._.models]))),{lockFn:y,isLock:U}=N(async()=>{try{const u=f.value.map(l=>({id:l.id,name:l.name,model:l.model,maxContext:l.maxContext,isActive:l.isActive,billingRule:l.billingRule}));await G(u),g.success(a("console-common.batchEditSuccess")),p("close",!0)}catch(u){console.error("批量编辑失败:",u),g.error(a("console-common.batchEditFailed"))}});return(u,l)=>{const $=T,R=j,d=q,s=z,C=D,B=J,x=I,w=L,A=O;return b(),M(A,{ui:{content:"max-w-4xl overflow-y-auto h-fit"},onClose:l[1]||(l[1]=e=>p("close",!1))},{title:o(()=>[n("div",null,[n("h3",H,c(r(a)("ai-provider.backend.model.batchEditTitle")),1),n("div",P,[m.provider?.iconUrl?(b(),v("div",Q,[t($,{src:m.provider.iconUrl,alt:m.provider.name,class:"h-4 w-4 rounded object-cover"},null,8,["src","alt"])])):(b(),v("div",W,[t(R,{name:"i-lucide-building-office",class:"h-4 w-4"})])),n("span",null,c(m.provider?.name),1)])])]),default:o(()=>[t(w,{state:r(f),onSubmit:r(y)},{default:o(()=>[t(B,{columns:k,data:r(f),sticky:"",class:"h-120",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r [&:nth-child(4)]:min-w-22",td:"border-b border-default cursor-pointer [&:nth-child(4)]:min-w-22",tr:"[&:has(>td[colspan])]:hidden"}},{"name-cell":o(({row:e})=>[t(s,{name:`rows.${e.index}.name`},{default:o(()=>[t(d,{modelValue:e.original.name,"onUpdate:modelValue":i=>e.original.name=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["name"])]),"model-cell":o(({row:e})=>[t(s,{name:`rows.${e.index}.model`},{default:o(()=>[t(d,{modelValue:e.original.model,"onUpdate:modelValue":i=>e.original.model=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["name"])]),"maxContext-cell":o(({row:e})=>[t(s,{name:`rows.${e.index}.maxContext`},{default:o(()=>[t(d,{modelValue:e.original.maxContext,"onUpdate:modelValue":i=>e.original.maxContext=i,ui:{base:"w-18"},type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["name"])]),"isActive-cell":o(({row:e})=>[t(s,{name:`rows.${e.index}.isActive`},{default:o(()=>[t(C,{modelValue:e.original.isActive,"onUpdate:modelValue":i=>e.original.isActive=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["name"])]),"billingRule-cell":o(({row:e})=>[n("div",X,[t(s,{name:`rows.${e.index}.billingRule.power`,class:"flex-1"},{default:o(()=>[t(d,{modelValue:e.original.billingRule.power,"onUpdate:modelValue":i=>e.original.billingRule.power=i,modelModifiers:{number:!0},type:"number",placeholder:"",min:0,ui:{base:"pr-15 width120"},onBlur:i=>{e.original.billingRule.power<0&&(e.original.billingRule.power=0)}},{trailing:o(()=>[n("span",Y,c(r(a)("ai-provider.backend.model.form.power")),1)]),_:1},8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["name"]),l[3]||(l[3]=n("span",{class:"shrink-0"},"/",-1)),t(s,{name:`rows.${e.index}.billingRule.tokens`,class:"flex-1"},{default:o(()=>[t(d,{modelValue:e.original.billingRule.tokens,"onUpdate:modelValue":i=>e.original.billingRule.tokens=i,modelModifiers:{number:!0},type:"number",placeholder:"",min:1,class:"w-full",disabled:!0,ui:{base:"pr-15 width120"},onBlur:i=>{e.original.billingRule.tokens<1&&(e.original.billingRule.tokens=1)}},{trailing:o(()=>[...l[2]||(l[2]=[n("span",{class:"text-muted-foreground text-sm"}," Tokens ",-1)])]),_:1},8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["name"])])]),_:1},8,["data"]),n("div",Z,[t(x,{color:"neutral",variant:"soft",onClick:l[0]||(l[0]=e=>p("close",!1))},{default:o(()=>[h(c(r(a)("console-common.cancel")),1)]),_:1}),t(x,{color:"primary",type:"submit",loading:r(U)},{default:o(()=>[h(c(r(a)("console-common.save")),1)]),_:1},8,["loading"])])]),_:1},8,["state","onSubmit"])]),_:1})}}});export{De as default};
