const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BTwrseSn.js","./CWb-zNEK.js","./B19A1O9i.js","./DChYRXkg.js","./-aacq5Xj.js","./D39yG5RA.js","./xli8Y-dU.js","./BaddN8Qc.js","./8-c-A7PB.js","./kRIii9yh.js","./BwjX1SxC.js","./Cfcu-t3n.js","./C6Y-ieo6.js","./b-_TUx9i.js","./DaNf1Wdt.js","./CKXZhss7.js","./Cpt2kRVT.js","./pUN2d83w.js","./B22A-h4k.js","./Bub1HYiY.js","./Qjq6OWkd.js","./BT1VXOqk.js","./Dn8X9Gvz.js","./DlAUqK2U.js","./B1XcE43x.js"])))=>i.map(i=>d[i]);
import{aD as $,aC as O,d as G,b as J,aq as R,a1 as K,f as T,g as j,aK as C,i as Q,c as f,o as h,m as t,l as n,t as a,p as e,k as i,q as g,z as W,R as X,F as Y,B as Z,n as ee,U as te}from"#entry";import{_ as se}from"./DJ8q3BOv.js";import{_ as ae}from"./Cgx-pZ0i.js";import oe from"./-aacq5Xj.js";import{_ as ce}from"./BnaFPtVJ.js";import ne from"./CjnkMdLn.js";import{_ as ie}from"./B19A1O9i.js";import{_ as le}from"./Bc7ldEoJ.js";import"./DDkKkiq3.js";function de(){return $("/user-schedule/config")}function re(k){return O("/user-schedule/config",k)}function me(k){return $("/user-schedule/schema",void 0)}const ue={class:"schedule-config-page pb-12"},pe={class:"mx-auto max-w-5xl space-y-6"},fe={class:"flex flex-wrap items-start justify-between gap-4"},he={class:"space-y-2"},ge={class:"text-xs font-semibold tracking-[0.3em] text-gray-400 uppercase"},_e={class:"text-2xl font-semibold text-gray-900 dark:text-white"},xe={class:"text-sm text-gray-500 dark:text-gray-400"},be={class:"flex flex-wrap items-center gap-2"},ye={class:"text-lg font-semibold"},ke={class:"text-sm text-gray-500"},ve={class:"space-y-6"},we={class:"text-xs text-gray-500"},Le={class:"grid gap-6 md:grid-cols-2"},Ce={class:"mt-1 text-xs text-gray-500"},Fe={class:"mt-1 text-xs text-gray-500"},Pe={class:"text-lg font-semibold"},Ve={class:"text-sm text-gray-500"},Ne={class:"space-y-4"},Se={class:"text-xs text-gray-500"},Ue={class:"rounded-xl bg-gray-50 p-4 text-xs text-gray-700 dark:bg-gray-900 dark:text-gray-200"},ze={class:"mb-2 font-medium"},Ie=["innerHTML"],Me={class:"text-lg font-semibold"},Te={class:"text-sm text-gray-500"},je={class:"space-y-3"},$e={class:"font-mono text-sm bg-blue-50 px-2 py-1 rounded text-blue-700 dark:bg-blue-500/10 dark:text-blue-300"},Be=["innerHTML"],De={class:"flex flex-wrap items-start justify-between gap-4"},Ee={class:"text-lg font-semibold"},Ae={class:"text-sm text-gray-500"},qe={class:"space-y-4"},He={class:"space-y-2 rounded-xl border border-gray-100 p-4 dark:border-gray-800 dark:bg-gray-900/40"},Oe={class:"flex flex-wrap items-center justify-between gap-2"},Ge={class:"text-xs uppercase tracking-wide text-gray-500"},Je={class:"font-mono text-sm text-gray-900 dark:text-gray-100"},Re={class:"whitespace-pre-wrap text-xs leading-relaxed text-gray-600 dark:text-gray-300"},Ke={key:0,class:"text-xs text-red-500 dark:text-red-400"},Qe={class:"flex items-center justify-between"},We={class:"text-xs uppercase tracking-wide text-gray-500"},Xe={class:"text-[11px] text-gray-500"},Ye={class:"mt-2 max-h-[420px] overflow-auto rounded-xl bg-gray-900/90 p-4 text-[11px] leading-relaxed text-emerald-100 dark:bg-black/60"},Ze={key:0,class:"whitespace-pre-wrap break-all"},et={key:1,class:"text-gray-500"},tt={class:"flex justify-end gap-3 pt-2"},mt=G({__name:"schedule",setup(k){const F=X(()=>te(()=>import("./BTwrseSn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url)),{t:s,tm:B}=J(),_=R(),p={modelId:"",temperature:.2,systemPrompt:"",contextLimit:5},c=K({...p}),r=T(null),v=T(!1),P=o=>o?o.replace(/(\{\{[^}]+\}\})/g,"<span class='text-blue-600 font-semibold dark:text-blue-400'>$1</span>"):"",D=j(()=>{const o=B("ai-schedule.backend.config.placeholders.items");return Array.isArray(o)?o:[{token:"{{current_time}}",description:"ISO timestamp of current server time"},{token:"{{user_timezone}}",description:"End-user timezone identifier"},{token:"{{upcoming_events}}",description:"Upcoming events formatted as id|title|start|end"}]}),V=(o,l,u)=>Math.min(u,Math.max(l,o)),w=()=>{const o=Number(c.temperature??p.temperature);if(Number.isNaN(o)){c.temperature=p.temperature;return}c.temperature=Number(V(o,0,1).toFixed(2))},L=()=>{const o=Number(c.contextLimit??p.contextLimit);if(Number.isNaN(o)){c.contextLimit=p.contextLimit;return}c.contextLimit=V(Math.round(o),1,20)},{lockFn:x,isLock:m}=C(async()=>{try{const o=await de();Object.assign(c,p,o??{}),w(),L()}catch(o){console.error("Failed to load schedule config:",o),_.error(s("ai-schedule.backend.config.messages.fetchFailed"))}}),N=j(()=>r.value?JSON.stringify(r.value.schema,null,2):""),{lockFn:S,isLock:U}=C(async()=>{try{v.value=!1;const o=await me();r.value=o}catch(o){v.value=!0,console.error("Failed to load schedule schema:",o),_.error(s("ai-schedule.backend.config.schema.messages.fetchFailed"))}}),{lockFn:E,isLock:z}=C(async()=>{if(!c.modelId){_.warning(s("ai-schedule.backend.config.messages.modelRequired"));return}w(),L();const o={modelId:c.modelId,temperature:c.temperature,contextLimit:c.contextLimit,systemPrompt:c.systemPrompt?.trim()||""};try{await re(o),_.success(s("ai-schedule.backend.config.messages.updateSuccess")),await x()}catch(l){console.error("Failed to update schedule config:",l),_.error(s("ai-schedule.backend.config.messages.updateFailed"))}});return Q(()=>{x(),S()}),(o,l)=>{const u=W,I=se,b=ae,M=oe,y=ce,A=ne,q=ie,H=le;return h(),f("div",ue,[t("div",pe,[t("header",fe,[t("div",he,[t("p",ge,a(e(s)("console-menu.aiConversation.scheduleConfig")),1),t("div",null,[t("h1",_e,a(e(s)("ai-schedule.backend.config.title")),1),t("p",xe,a(e(s)("ai-schedule.backend.config.description")),1)])]),t("div",be,[n(u,{variant:"soft",color:"neutral",size:"md",icon:"i-lucide-refresh-cw",onClick:e(x),loading:e(m)},{default:i(()=>[g(a(e(s)("ai-schedule.backend.config.actions.refresh")),1)]),_:1},8,["onClick","loading"]),n(I,{codes:["user-schedule:update-config"]},{default:i(()=>[n(u,{color:"primary",size:"md",type:"submit",form:"schedule-config-form",loading:e(z),disabled:e(m)},{default:i(()=>[g(a(e(s)("console-common.save")),1)]),_:1},8,["loading","disabled"])]),_:1})])]),n(H,{id:"schedule-config-form",state:e(c),class:"space-y-6",onSubmit:e(E)},{default:i(()=>[n(y,null,{header:i(()=>[t("div",null,[t("h3",ye,a(e(s)("ai-schedule.backend.config.model.title")),1),t("p",ke,a(e(s)("ai-schedule.backend.config.model.description")),1)])]),default:i(()=>[t("div",ve,[n(b,{label:e(s)("ai-schedule.backend.config.model.label"),name:"modelId",required:""},{default:i(()=>[n(e(F),{modelValue:e(c).modelId,"onUpdate:modelValue":l[0]||(l[0]=d=>e(c).modelId=d),console:!0,"default-selected":!1,disabled:e(m),"show-description":!1,"button-ui":{color:"neutral",size:"lg",class:"w-full justify-between rounded-lg"}},null,8,["modelValue","disabled"])]),_:1},8,["label"]),t("p",we,a(e(s)("ai-schedule.backend.config.model.helper")),1),t("div",Le,[t("div",null,[n(b,{label:e(s)("ai-schedule.backend.config.temperature.label"),name:"temperature"},{default:i(()=>[n(M,{type:"number",step:"0.05",min:"0",max:"1",modelValue:e(c).temperature,"onUpdate:modelValue":l[1]||(l[1]=d=>e(c).temperature=d),modelModifiers:{number:!0},onBlur:w,disabled:e(m),size:"lg"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),t("p",Ce,a(e(s)("ai-schedule.backend.config.temperature.description")),1)]),t("div",null,[n(b,{label:e(s)("ai-schedule.backend.config.contextLimit.label"),name:"contextLimit"},{default:i(()=>[n(M,{type:"number",min:"1",max:"20",step:"1",modelValue:e(c).contextLimit,"onUpdate:modelValue":l[2]||(l[2]=d=>e(c).contextLimit=d),modelModifiers:{number:!0},onBlur:L,disabled:e(m),size:"lg"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),t("p",Fe,a(e(s)("ai-schedule.backend.config.contextLimit.description")),1)])])])]),_:1}),n(y,null,{header:i(()=>[t("div",null,[t("h3",Pe,a(e(s)("ai-schedule.backend.config.systemPrompt.title")),1),t("p",Ve,a(e(s)("ai-schedule.backend.config.systemPrompt.description")),1)])]),default:i(()=>[t("div",Ne,[n(b,{label:e(s)("ai-schedule.backend.config.systemPrompt.label"),name:"systemPrompt"},{default:i(()=>[n(A,{modelValue:e(c).systemPrompt,"onUpdate:modelValue":l[3]||(l[3]=d=>e(c).systemPrompt=d),placeholder:e(s)("ai-schedule.backend.config.systemPrompt.placeholder"),rows:14,disabled:e(m),class:"font-mono w-full",ui:{root:"w-full"}},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),t("p",Se,a(e(s)("ai-schedule.backend.config.systemPrompt.helper")),1),t("div",Ue,[t("p",ze,a(e(s)("ai-schedule.backend.config.systemPrompt.preview")),1),t("div",{class:"text-[11px] leading-relaxed break-words whitespace-pre-wrap font-mono",innerHTML:P(e(c).systemPrompt?.trim()||e(s)("ai-schedule.backend.config.systemPrompt.example"))},null,8,Ie)])])]),_:1}),n(y,null,{header:i(()=>[t("div",null,[t("h3",Me,a(e(s)("ai-schedule.backend.config.placeholders.title")),1),t("p",Te,a(e(s)("ai-schedule.backend.config.placeholders.description")),1)])]),default:i(()=>[t("div",je,[(h(!0),f(Y,null,Z(D.value,d=>(h(),f("div",{key:d.token,class:"flex flex-wrap items-center justify-between gap-2 rounded-lg border border-gray-100 px-4 py-3 dark:border-gray-800"},[t("code",$e,a(d.token),1),t("div",{class:"flex-1 text-sm text-gray-600 dark:text-gray-300",innerHTML:P(d.description)},null,8,Be)]))),128))])]),_:1}),n(y,null,{header:i(()=>[t("div",De,[t("div",null,[t("h3",Ee,a(e(s)("ai-schedule.backend.config.schema.title")),1),t("p",Ae,a(e(s)("ai-schedule.backend.config.schema.description")),1)]),n(u,{variant:"soft",color:"neutral",size:"sm",icon:"i-lucide-refresh-cw",onClick:e(S),loading:e(U)},{default:i(()=>[g(a(e(s)("ai-schedule.backend.config.schema.actions.refresh")),1)]),_:1},8,["onClick","loading"])])]),default:i(()=>[t("div",qe,[t("div",He,[t("div",Oe,[t("div",null,[t("p",Ge,a(e(s)("ai-schedule.backend.config.schema.nameLabel")),1),t("p",Je,a(r.value?.name||"â€”"),1)]),n(q,{color:r.value?.strict?"success":"neutral",variant:"soft"},{default:i(()=>[g(a(r.value?.strict?e(s)("ai-schedule.backend.config.schema.strictEnabled"):e(s)("ai-schedule.backend.config.schema.strictDisabled")),1)]),_:1},8,["color"])]),t("p",Re,a(r.value?.summary||e(s)("ai-schedule.backend.config.schema.emptySummary")),1),v.value?(h(),f("p",Ke,a(e(s)("ai-schedule.backend.config.schema.messages.fetchFailed")),1)):ee("",!0)]),t("div",null,[t("div",Qe,[t("p",We,a(e(s)("ai-schedule.backend.config.schema.jsonTitle")),1),t("span",Xe,a(e(s)("ai-schedule.backend.config.schema.helper")),1)]),t("div",Ye,[N.value?(h(),f("pre",Ze,""+a(N.value)+`
                                    `,1)):(h(),f("p",et,a(e(U)?e(s)("ai-schedule.backend.config.schema.loading"):e(s)("ai-schedule.backend.config.schema.emptyJson")),1))])])])]),_:1}),t("div",tt,[n(u,{variant:"soft",color:"neutral",loading:e(m),icon:"i-lucide-refresh-ccw",onClick:e(x)},{default:i(()=>[g(a(e(s)("ai-schedule.backend.config.actions.refresh")),1)]),_:1},8,["loading","onClick"]),n(I,{codes:["user-schedule:update-config"]},{default:i(()=>[n(u,{color:"primary",size:"lg",type:"submit",loading:e(z)},{default:i(()=>[g(a(e(s)("console-common.save")),1)]),_:1},8,["loading"])]),_:1})])]),_:1},8,["state","onSubmit"])])])}}});export{mt as default};
